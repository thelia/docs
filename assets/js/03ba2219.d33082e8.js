"use strict";(globalThis.webpackChunkthelia=globalThis.webpackChunkthelia||[]).push([[4841],{5401:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>d,contentTitle:()=>s,default:()=>l,frontMatter:()=>c,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"getting_started/docker","title":"Dockerize your Thelia","description":"A docker configuration is provided in the repository of Thelia. It uses docker compose.","source":"@site/docs/getting_started/docker.md","sourceDirName":"getting_started","slug":"/getting_started/docker","permalink":"/docs/docs/getting_started/docker","draft":false,"unlisted":false,"editUrl":"https://github.com/thelia/docs/edit/main/docs/getting_started/docker.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Dockerize your Thelia","sidebar_position":6},"sidebar":"myAutogeneratedSidebar","previous":{"title":"Apache configuration","permalink":"/docs/docs/getting_started/apache_configuration"},"next":{"title":"Trigger Creation Fails","permalink":"/docs/docs/getting_started/troubleshooting/trigger_remove_free_text_feature_av"}}');var r=n(4848),i=n(8453);const c={title:"Dockerize your Thelia",sidebar_position:6},s=void 0,d={},h=[{value:"Get the project",id:"get-the-project",level:2},{value:"With composer",id:"with-composer",level:3},{value:"Or download the archive",id:"or-download-the-archive",level:3},{value:"Run docker",id:"run-docker",level:2},{value:"Initial commands",id:"initial-commands",level:2},{value:"To go further",id:"to-go-further",level:2},{value:"Shut down docker",id:"shut-down-docker",level:2},{value:"How to change the configuration",id:"how-to-change-the-configuration",level:2}];function a(e){const o={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.p,{children:"A docker configuration is provided in the repository of Thelia. It uses docker compose."}),"\n",(0,r.jsxs)(o.p,{children:["It requires obviously ",(0,r.jsx)(o.a,{href:"https://docker.com/",children:"docker"})," and ",(0,r.jsx)(o.a,{href:"http://docs.docker.com/compose/",children:"docker compose"})]}),"\n",(0,r.jsx)(o.h2,{id:"get-the-project",children:"Get the project"}),"\n",(0,r.jsx)(o.h3,{id:"with-composer",children:"With composer"}),"\n",(0,r.jsxs)(o.p,{children:["Run the composer command shown in the ",(0,r.jsx)(o.a,{href:"/docs/getting_started/Installation",children:"dedicated page"}),"."]}),"\n",(0,r.jsx)(o.h3,{id:"or-download-the-archive",children:"Or download the archive"}),"\n",(0,r.jsxs)(o.p,{children:["You can download the archive from official ",(0,r.jsx)(o.a,{href:"https://github.com/thelia/thelia/releases",children:"releases pages"}),"."]}),"\n",(0,r.jsx)(o.h2,{id:"run-docker",children:"Run docker"}),"\n",(0,r.jsxs)(o.blockquote,{children:["\n",(0,r.jsxs)(o.p,{children:["\u26a0\ufe0f ",(0,r.jsx)(o.strong,{children:"Important"})," : First, copy and paste content from file ",(0,r.jsx)(o.code,{children:".env.docker"})," to ",(0,r.jsx)(o.code,{children:".env"})," file.\nChange default values if needed, but default values should work. You should overrides default values with a ",(0,r.jsx)(o.code,{children:".env.local"})," file.\nThen, add the following line to your ",(0,r.jsx)(o.code,{children:".env"})," file :"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"MYSQL_DATABASE=thelia\nMYSQL_ROOT_PASSWORD=root\nMYSQL_USER=thelia\nMYSQL_PASSWORD=thelia\n"})}),"\n"]}),"\n",(0,r.jsx)(o.p,{children:"Then execute this command from the root path of the project :"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"docker compose up -d\n"})}),"\n",(0,r.jsxs)(o.p,{children:["Your website should be accessible here, but not yet installed : ",(0,r.jsx)(o.a,{href:"http://localhost:8080",children:"http://localhost:8080"}),'  . You should see "Thelia is not installed".']}),"\n",(0,r.jsx)(o.h2,{id:"initial-commands",children:"Initial commands"}),"\n",(0,r.jsx)(o.p,{children:"To be able to run PHP command, you first need to execute this if you need :"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"docker compose exec php-fpm bash\n"})}),"\n",(0,r.jsxs)(o.p,{children:["You will be inside the php docker container. From here, you have to follow the classic installation process of Thelia ( cf: ",(0,r.jsx)(o.a,{href:"/docs/getting_started/Installation",children:"installation page"})," )"]}),"\n",(0,r.jsx)(o.p,{children:"A few differences :"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:["you have to use the database host ",(0,r.jsx)(o.code,{children:"docker-thelia-mariadb"})," instead of ",(0,r.jsx)(o.code,{children:"localhost"})]}),"\n",(0,r.jsxs)(o.li,{children:["use ",(0,r.jsx)(o.code,{children:"thelia"})," (if you didn't change it) as the database name, user and password"]}),"\n",(0,r.jsx)(o.li,{children:"to install modern theme, please execute command from your host (not inside docker container)"}),"\n",(0,r.jsx)(o.li,{children:"execute php commands of the installation process inside the docker container (only php commands)"}),"\n"]}),"\n",(0,r.jsx)(o.p,{children:"If you have permission errors at the end of the execution or in the browser, simply run this from your host terminal :"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"sudo chmod -R 777 var/log\nsudo chmod -R 777 var/cache\nsudo chmod -R 777 web\n"})}),"\n",(0,r.jsxs)(o.p,{children:["From here, your Thelia might be correctly installed.\nYour website should be accessible here : ",(0,r.jsx)(o.a,{href:"http://localhost:8080",children:"http://localhost:8080"})," ."]}),"\n",(0,r.jsx)(o.h2,{id:"to-go-further",children:"To go further"}),"\n",(0,r.jsxs)(o.p,{children:["Environment variables are set in the ",(0,r.jsx)(o.code,{children:".env"})," file, if you change them, you have to restart the container :"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-bash",children:"docker compose down --remove-orphans\ndocker compose up -d\ndocker compose exec php-fpm bash\nrm -rf var/cache/*\n"})}),"\n",(0,r.jsx)(o.p,{children:"You can now run commands like this inside your container :"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"php Thelia c:c\nphp Thelia admin:create\nphp local/setup/import.php\n"})}),"\n",(0,r.jsx)(o.h2,{id:"shut-down-docker",children:"Shut down docker"}),"\n",(0,r.jsx)(o.p,{children:"Run this command from your root path if you need to stop your docker containers:"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"docker compose down --remove-orphans\n"})}),"\n",(0,r.jsx)(o.h2,{id:"how-to-change-the-configuration",children:"How to change the configuration"}),"\n",(0,r.jsxs)(o.p,{children:["All the configuration can be customize for your own project. It uses the official ",(0,r.jsx)(o.a,{href:"https://hub.docker.com/_/php/",children:"php image"})," provided by docker so you can change the php version as you want.\nYou can also install all the extension you want."]}),"\n",(0,r.jsxs)(o.p,{children:["Each time you modify the configuration, you have to rebuild the containers : ",(0,r.jsx)(o.code,{children:"docker composer build --no-cache"})]})]})}function l(e={}){const{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,o,n)=>{n.d(o,{R:()=>c,x:()=>s});var t=n(6540);const r={},i=t.createContext(r);function c(e){const o=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),t.createElement(i.Provider,{value:o},e.children)}}}]);